<?xml version='1.0' encoding='windows-1251' ?>
<ui:composition 
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:s="http://jboss.com/products/seam/taglib"
      xmlns:c="http://java.sun.com/jstl/core">

<h3 class="ui-widget-header" >Подробно</h3>

<!--div class="ui-widget-header" style="background:#E6E6E6;">
  <a4j:outputPanel id="outCenterBottomHeader">
   <table>
      <tr>
       <td>
        <s:div rendered="#{param['remoteAudit']!=null}">
        <table style="width:500px" border="0">
         <tr>
         <td>
           <s:div rendered="#{param['sessionId']!=null}">
            
            <h:outputText value="Искать соответсвия по : "/>
            
            <a4j:commandButton style="width:50px;" 
                value="ФИО"
                reRender="outCBmpCrt" ajaxSingle="true"
                action="#{bindManager.forViewCrt}"
                oncomplete="#{rich:component('CBmpCrt')}.show();"
                rendered="#{authenticator.accessPerm('002','2')}"
                styleClass="but_class">
            <f:param name="onCreate" value="1"/>
            <f:param name="remoteAudit" value="OpenCrtFact"/>
            <f:param name="#{param['sessionId']!=null ? 'sessionId' : 'xxx1'}" value="#{param['sessionId']}"/>
          </a4j:commandButton>
            
            <a4j:commandButton style="width:50px;margin-left:10px;"
                ajaxSingle="true" reRender="outCBmpUpd"
                value="ФИ" action="#{bindManager.forViewUpdDel}"
                oncomplete="#{rich:component('CBmpUpd')}.show();"
                rendered="#{authenticator.accessPerm('002','3') and 
                (currentUser.idUser!=param['sessionId'] or currentUser.idUser==linksMap.superUserCode)
                and (bindBeanView.idUser!=linksMap.superUserCode or currentUser.idUser==linksMap.superUserCode) and 
                (bindBeanView.isSysAdmin!=1 or currentUser.idUser==linksMap.superUserCode)}"
                styleClass="but_class">
              <f:param name="onUpdate" value="1"/>
              <f:param name="remoteAudit" value="OpenUpdFact"/>
              <f:param name="sessionId" value="#{param['sessionId']}"/>
            </a4j:commandButton>
            
            <a4j:commandButton style="width:50px;margin-left:10px;"
                ajaxSingle="true" reRender="outCBmpUpdRole"
                value="ФО" action="#{bindManager.forViewUpdDel}"
                oncomplete="#{rich:component('CBmpUpdRole')}.show();"
                rendered="#{authenticator.accessPerm('002','3') and 
                (currentUser.idUser!=param['sessionId'] or currentUser.idUser==linksMap.superUserCode)
                and (bindBeanView.idUser!=linksMap.superUserCode or currentUser.idUser==linksMap.superUserCode) and 
                (bindBeanView.isSysAdmin!=1 or currentUser.idUser==linksMap.superUserCode)}"
                styleClass="but_class">
              <f:param name="onUpdateRole" value="1"/>
              <f:param name="remoteAudit" value="OpenUpdFact"/>
              <f:param name="sessionId" value="#{param['sessionId']}"/>
            </a4j:commandButton>
            
             <a4j:commandButton style="width:50px;margin-left:10px;"
                ajaxSingle="true" reRender="outCBmpUpdGroup"
                value="Ф" action="#{bindManager.forViewUpdDel}"
                oncomplete="#{rich:component('CBmpUpdGroup')}.show();"
                rendered="#{authenticator.accessPerm('002','3') and 
                (currentUser.idUser!=param['sessionId'] or currentUser.idUser==linksMap.superUserCode)
                and (bindBeanView.idUser!=linksMap.superUserCode or currentUser.idUser==linksMap.superUserCode) and 
                (bindBeanView.isSysAdmin!=1 or currentUser.idUser==linksMap.superUserCode)}"
                styleClass="but_class">
              <f:param name="onUpdateGroup" value="1"/>
              <f:param name="remoteAudit" value="OpenUpdFact"/>
              <f:param name="sessionId" value="#{param['sessionId']}"/>
            </a4j:commandButton>
             
          </s:div>
         </td> 
       </tr>
      </table> 
     </s:div>
         </td>
        <td height="25px;">
         <h:outputText value="&amp;nbsp;" escape="false"/>
       </td>
      </tr>
     </table>
   </a4j:outputPanel>
</div-->


<div class="ui-layout-content">
<a4j:outputPanel id="outCenterBottom">

<table style="width:100%;" border="0">
<tr>
<td width="90%">
  
 <!--s:div style="margin:5px;" rendered="#{param['sessionId']!=null}"-->
 <div style="margin:5px;"> 
  
 <c:if test="#{bindManager.evaluteForBean}"> 
  
  <h:form>

  <h:messages style="color:red" globalOnly="false" />
 
    <table style="width:100%; font-size:12px;" border="0">
          <c:forEach items="#{bindManager.auditItemsListContext}" var="field"> 
          <!--a4j:repeat var="field" rowKeyVar="rkv"
                      value="#{bindManager.auditItemsListContext}"-->
           <tr>
            <td width="150px" height="25px" class="table_left_header">
              <h:outputText value="#{field.itemLabel}"/>
            </td>
            <td>
               <h:outputText value="#{bindBeanView[field.itemField]}"/>
            </td>
          </tr>
         <!--/a4j:repeat-->
         </c:forEach>    
          <tr>
            <td width="150px" height="25px" valign="top" 
                style="padding-top:10px;" class="table_left_header">
               <h:outputText value="Роли:"/>
            </td>
            <td style="padding-top:10px;" valign="top">
            <table style="width:100%;" border="0">
             <c:forEach items="#{bindManager.listBindArmForView}" var="vrecord"> 
             <!--a4j:repeat var="vrecord" value="#{bindManager.listBindArmForView}"-->
               <tr>
                 <td height="15" style="font-weight:bold;">
                   <h:outputText value=" #{vrecord.name}:" />
                 </td>
               </tr>
               <tr>
                 <td>
                   <table style="width:100%;margin-bottom:10px;">
                     <c:forEach items="#{vrecord.rolList}" var="vit"> 
                     <!--ui:repeat var="vit" value="#{vrecord.rolList}"-->
                      <tr>
                        <td height="15" style="padding-left:30px;">
                          <h:outputText value=" #{vit.roleTitle}" />
                         </td>
                       </tr>
                     <!--/ui:repeat-->
                     </c:forEach> 
                    </table> 
                 </td>
               </tr>
               <!--/a4j:repeat-->
               </c:forEach>  
             </table> 
           </td>
          </tr>
          <tr>
            <td width="150px" height="25px" valign="top" 
                style="padding-top:10px;" class="table_left_header">
               <h:outputText value="Роли через группы:"/>
            </td>
            <td style="padding-top:10px;" valign="top">
            <table style="width:100%;" border="0">
             <c:forEach items="#{bindManager.listBindGroupForView}" var="grecord"> 
              <tr>
                 <td height="15" style="font-weight:bold;">
                   <h:outputText value=" #{grecord.full}:" />
                 </td>
               </tr>
               <tr>
                 <td>
                   <table style="width:100%;margin-bottom:10px;">
                     <c:forEach items="#{grecord.armList}" var="git"> 
                       <tr>
                        <td height="15" style="padding-left:30px;">
                          <h:outputText value=" #{git.name}:" />
                         </td>
                       </tr>
                       <tr>
                         <td>
                          <table style="width:100%;margin-bottom:10px;">
                            <c:forEach items="#{git.rolList}" var="g2it"> 
                             <tr>
                              <td height="15" style="padding-left:60px;">
                                <h:outputText value=" #{g2it.roleTitle}" />
                             </td>
                            </tr>
                         </c:forEach> 
                    </table> 
                 </td>
               </tr>
                      </c:forEach> 
                    </table> 
                 </td>
               </tr>
               </c:forEach>  
             </table> 
           </td>
          </tr>
          <!--tr>
            <td width="150px" height="25px" class="table_left_header">
              <h:outputText value="Создал"/>
            </td>
            <td>
               <h:outputText value="#{bindBean.crtUserName}"/>
            </td>
          </tr>
          <tr>
            <td width="150px" height="25px" class="table_left_header">
              <h:outputText value="Дата создания"/>
            </td>
            <td>
               <h:outputText value="#{bindBean.created}">
                  <s:convertDateTime pattern="dd.MM.yy HH:mm:ss"/>
               </h:outputText>   
            </td>
          </tr>
          <tr>
            <td width="150px" height="25px" class="table_left_header">
              <h:outputText value="Редактировал"/>
            </td>
            <td>
               <h:outputText value="#{bindBean.updUserName}"/>
            </td>
          </tr>
          <tr>
            <td width="150px" height="25px" class="table_left_header">
              <h:outputText value="Дата редактирования"/>
            </td>
            <td>
               <h:outputText value="#{bindBean.modified}">
                  <s:convertDateTime pattern="dd.MM.yy HH:mm:ss"/>
               </h:outputText>
            </td>
          </tr-->
         </table>
        </h:form>
      </c:if>
       </div>
       <!--/s:div-->
   </td>
   <td width="90px" valign="top">
    <!--rich:panel style="margin:5px 5px 0 0;">
     <f:facet name="header">
       Действия:
      </f:facet>
     <a4j:form>
      <a4j:commandButton style="width:60px;" value="Создать"
       reRender="outCBmpCrt" ajaxSingle="true"
       oncomplete="#{rich:component('CBmpCrt')}.show();"
       rendered="#{authenticator.accessPerm('002','2')}"
       styleClass="but_class">
          <f:param name="onCreate" value="1"/>
      </a4j:commandButton>
     
     <s:div rendered="#{param['idBind']!=null}">
       <a4j:commandButton style="margin-top:5px;width:60px;"
         ajaxSingle="true" reRender="outCBmpUpd"
         value="Изменить" action="#{bindManager.forView}"
         oncomplete="#{rich:component('CBmpUpd')}.show();"
         rendered="#{authenticator.accessPerm('002','3')}"
         styleClass="but_class">
         <f:param name="onUpdate" value="1"/>
         <f:param name="idBind" value="#{param['idBind']}"/>
       </a4j:commandButton>
       
       <a4j:commandButton 
         reRender="outCBmpDel"
         value="Удалить"  style="margin-top:5px;width:60px;"
         action="#{bindManager.forView}"
         oncomplete="#{rich:component('CBmpDel')}.show();"
         rendered="#{authenticator.accessPerm('002','4')}"
         styleClass="but_class">
         <f:param name="onDelete" value="1"/>
         <f:param name="idBind" value="#{param['idBind']}"/>
       </a4j:commandButton>
    
     </s:div>
    </a4j:form>
   </rich:panel-->
 </td>
 </tr>
 </table>
  
  </a4j:outputPanel>
 
 </div>
 
 <div class="ui-widget-footer" style="background:#E6E6E6;">
 
 <!--a4j:outputPanel id="outCBmpCrtPre">
   <rich:modalPanel id="CBmpCrtPre" rendered="#{param['onCreatePre']!=null or param['onCreate']!=null}"
    width="600" autosized="true" onbeforeshow="setHDiv('CBmpCrtHDivPre');">
      <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователь"></h:outputText>
             </h:panelGroup>
      </f:facet>
       <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpCrtPre')}.hide();"
                value="/img/icons/close.gif" />
              </h:panelGroup>
        </f:facet>
        <div id="CBmpCrtHDivPre" style="width:100%;height:500px;overflow:auto;"> 
         <h:form id="CBformCrtPre">
           <table style="width:90%;">
           <tr>
            <td>
            <h:outputText value="Фамилия"/></td>
            <td></td>
           </tr>
           
          <tr>
           <td align="center" height="35px">
              <a4j:commandButton value="Отмена"
                     onclick="#{rich:component('CBmpCrtPre')}.hide();return false;"
                     styleClass="but_class"/>
               <a4j:commandButton style="width:60px;" value="Создать2"
                reRender="outCBmpCrt"
                action="#{bindManager.forViewCrt}"
                oncomplete="#{rich:component('CBmpCrt')}.show();"
                rendered="#{authenticator.accessPerm('002','2')}"
                styleClass="but_class"
                onclick="#{rich:component('CBmpCrtPre')}.hide();">
            <f:param name="onCreate" value="1"/>
            <f:param name="remoteAudit" value="OpenCrtFact"/>
            <f:param name="#{param['sessionId']!=null ? 'sessionId' : 'xxx1'}" value="#{param['sessionId']}"/>
          </a4j:commandButton>
               </td>
            </tr>
            </table>
            </h:form>
        </div>
       </rich:modalPanel>
     </a4j:outputPanel-->
 
 
 <a4j:outputPanel id="outCBmpCrt">
   <rich:modalPanel id="CBmpCrt" rendered="#{param['onCreate']!=null}"
    width="600" autosized="true" 
    onbeforeshow="/*setHDiv('CBmpCrtHDiv');*/
    document.getElementById('CBformCrt:statesinput').value='';
    reset_radio_stiu('CBformCrt');">
      <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователь"></h:outputText>
             </h:panelGroup>
      </f:facet>
       <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpCrt')}.hide();"
                value="/img/icons/close.gif" />
              </h:panelGroup>
        </f:facet>
        <!--div id="CBmpCrtHDiv" style="width:100%;height:500px;overflow:auto;"--> 
         <h:form id="CBformCrt">
         
         
              <!--rich:comboBox selectFirstOnUpdate="false"
               defaultLabel="Enter some value">
               <s:selectItems value="#{clOrgManager.listOrg}" var="ind" label="#{ind.full}"/>
               <s:convertEntity />
             </rich:comboBox-->
             
           <table style="width:90%;">
           <tr>
            <td width="100px" height="20px">
            <h:outputText value="Организация"/></td>
            <td>
            <a4j:status startText="Выполняется загрузка...."  startStyle="color:green;font: bold 8pt arial" 
              id="statusCompOrg" forceId="true" />
             <a4j:region>
              <h:panelGrid columns="3" border="0" cellpadding="0" cellspacing="0">
                <h:inputText maxlength="50" size="55" style="margin:0px;" id="statesinput"/>
                <h:graphicImage value="/img/error.gif"
                    onclick="document.getElementById('CBformCrt:statesinput').value='';"
                    alt="" />
                <h:graphicImage value="/img/icons/arrow.png"
                    onclick="#{rich:component('suggestion')}.callSuggestion(true)"
                    alt="" />
            </h:panelGrid>
          <rich:suggestionbox height="400" width="500" status="statusCompOrg"
            usingSuggestObjects="true"  for="statesinput" 
            suggestionAction="#{clOrgManager.autocomplete}" var="cap"
            fetchValue="#{cap.full}" id="suggestion"
             minChars="1" ajaxSingle="true" 
             onselect="invokeClOrgSelect(#{rich:component('suggestion')}.getSelectedItems().pluck('signObject'));"
             nothingLabel="Нет данных">
              <f:param name="onCreate" value="1"/> 
              <f:param name="remoteAudit" value="clOrgSuggestFact"/>
            <!--h:column>
                <h:outputText value="#{cap.signObject}" />
            </h:column-->
            <h:column>
                <h:outputText value="#{cap.full}" />
            </h:column>
            <!--a4j:support event="onselect" ajaxSingle="true" reRender="outCBmpBindCrt">
              <f:param name="onCreate" value="1"/> 
              <f:param name="remoteAudit" value="clOrgSelectFact"/>
              <f:param name="signObject" value="#{cap.signObject}"/>
              <f:setPropertyActionListener value="#{cap.label}" target="#{bean.property1}" />
            </a4j:support-->
        </rich:suggestionbox>
          </a4j:region>
          
           
        </td>
           </tr>
           <tr>
            <td colspan="2">
            <a4j:outputPanel id="outCBmpOrgHiddenCrt" >
            
             <h:inputHidden  id ="clorgso" value="#{clOrgBean.signObject}"/>
             
             <h:panelGroup rendered="#{param['signObject']!=null}">
        <table style="width:99%;">
         <tr>
            <td width="100px" height="20px" valign="top">
            <h:outputText value="Выбрана организация"/></td>
            <td> 
             <!--h:panelGrid columns="2" border="0" cellpadding="0" cellspacing="0">
                <h:outputText value="Название: " /-->
                <h:outputText value="#{clOrgBean.full}" />
             <!--/h:panelGrid-->
        </td>
        </tr>
        </table>
        </h:panelGroup>
           </a4j:outputPanel>
            </td>
            </tr>
            
           <tr>
            <td width="100px" height="20px" valign="top">
            <h:outputText value="Пользователь"/></td>
            <td>
             <h:selectOneRadio id="stiu" layout="lineDirection" 
                               value="1" onchange="/*invokeTypeUserInput(this.value);*/" 
                               onclick="invokeTypeUserInput(this.value);">
	  	       <f:selectItem itemLabel="из справочника" itemValue="1"/>
	  	       <f:selectItem itemLabel="ручной ввод" itemValue="2"/>
              </h:selectOneRadio>
            </td>
            </tr>
             <tr>
            <td colspan="2">
            
            
         <a4j:outputPanel id="outCBmpBindFIOSectCrt" >    
            
         <h:panelGroup rendered="#{(param['remoteAudit']!='CrtFact' and param['typeUserInput']!='2') or (param['remoteAudit']=='CrtFact' and param['CBformCrt:cluso']!=null)}">
           <!--/table-->
       <!--rich:tabPanel switchType="client" style="margin-bottom:10px;">
          <rich:tab label="Справочник" style="padding-top:10px;"-->
          <table style="width:99%;">
            <tr>
            <td width="100px" height="20px" valign="top">
            <h:outputText value="ФИО"/></td>
            <td>
        <a4j:outputPanel id="outCBmpBindCrt" >   
             
        <h:panelGroup rendered="#{param['signObject']!=null 
               and (param['remoteAudit']=='clOrgSelectFact' 
               or param['remoteAudit']=='clUsrSuggestFact'
               or param['remoteAudit']=='clUsrTUIFact')}">
       
        <a4j:status startText="Выполняется загрузка...."  startStyle="color:green;font: bold 8pt arial" 
              id="statusCompBind" forceId="true" />
        <a4j:region>
              <h:panelGrid columns="3" border="0" cellpadding="0" cellspacing="0">
                <h:inputText maxlength="50" size="55" style="margin:0px;" id="statesinput_bind" />
                 <h:graphicImage value="/img/error.gif"
                    onclick="document.getElementById('CBformCrt:statesinput_bind').value='';"
                    alt="" />
                <h:graphicImage value="/img/icons/arrow.png"
                    onclick="#{rich:component('suggestion_bind')}.callSuggestion(true)"
                    alt="" />
               
            </h:panelGrid>
          <rich:suggestionbox height="400" width="500" status="statusCompBind"
            usingSuggestObjects="true"  for="statesinput_bind" 
            suggestionAction="#{clUsrManager.autocomplete}" var="cap"
            fetchValue="#{cap.fio}" id="suggestion_bind"
             minChars="1" ajaxSingle="true"
             onselect="invokeClBindSelect(#{rich:component('suggestion_bind')}.getSelectedItems().pluck('signObject'));"
             nothingLabel="Нет данных">
              <f:param name="onCreate" value="1"/> 
              <f:param name="remoteAudit" value="clUsrSuggestFact"/>
              <f:param name="signObject" value="#{param['signObject']}"/>
            <!--h:column>
                <h:graphicImage value="#{cap.stateFlag}" />
            </h:column-->
            <h:column>
                <h:outputText value="#{cap.fio}" />
            </h:column>
            <!--a4j:support event="onselect" action="#{bean.action}">
              <f:setPropertyActionListener value="#{cap.label}" target="#{bean.property1}" />
           </a4j:support-->
        </rich:suggestionbox>
        </a4j:region>
        </h:panelGroup>
        
        
        <h:panelGroup rendered="#{!(param['signObject']!=null 
               and (param['remoteAudit']=='clOrgSelectFact' 
               or param['remoteAudit']=='clUsrSuggestFact'
               or param['remoteAudit']=='clUsrTUIFact'))}">
        <h:outputText value="Не выбрана организация" style="font-style:italic; color:silver;"/>
       </h:panelGroup>
        </a4j:outputPanel>
 
       </td>
      </tr> 
        <tr>
            <td colspan="2">      
         <a4j:outputPanel id="outCBmpBindDataCrt" >   
      
         <h:inputHidden id ="cluso" value="#{clUsrBean.signObject}"/>
         
        <h:panelGroup rendered="#{param['remoteAudit']=='clUsrSelectFact'}">
        <table style="width:99%;">
         <tr>
            <td width="100px" height="20px" valign="top">
            <h:outputText value="Выбран пользователь"/></td>
            <td> 
            <!--h:outputText value="#{cap.fio}" /-->
             <h:panelGrid columns="2" border="0" cellpadding="0" cellspacing="0">
                <h:outputText value="ФИО: " />
                <h:outputText value="#{clUsrBean.fio}" />
                <h:outputText value="Подразделение: " />
                <h:outputText value="#{clUsrBean.department}" />
                <h:outputText value="Должность: " />
                <h:outputText value="#{clUsrBean.position}" />
                <h:outputText value="Телефон:" />
                <h:outputText value="#{clUsrBean.phone}" />
                <h:outputText value="E-mail:" />
                <h:outputText value="#{clUsrBean.email}" />
            </h:panelGrid>
        </td>
        </tr>
        </table>
        </h:panelGroup>
        </a4j:outputPanel>
        
      </td>
      </tr>
      </table>
      </h:panelGroup>
          <h:panelGroup rendered="#{(param['remoteAudit']!='CrtFact' and param['typeUserInput']=='2') or (param['remoteAudit']=='CrtFact' and param['CBformCrt:cluso']==null)}">
         <!--/rich:tab>
          <rich:tab label="Произвольное" style="padding-top:10px;"-->
          <table style="width:90%;">
           <tr>
            <td width="100px" height="20px">
            <h:outputText value="Подразделение"/></td>
            <td><h:inputText value="#{bindBeanCrt.department}"
                            id="depart" maxlength="255" size="55"/></td>
            </tr>
             <tr>
            <td width="100px" height="20px">
            <h:outputText value="Должность"/></td>
            <td><h:inputText value="#{bindBeanCrt.position}"
                 id="doljn" maxlength="255" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Фамилия"/></td>
            <td><h:inputText value="#{bindBeanCrt.surname}"
                          id="name1" maxlength="45" size="55"/></td>
           </tr>
           <tr>
            <td width="100px" height="20px">
            <h:outputText value="Имя"/></td>
            <td><h:inputText value="#{bindBeanCrt.name1}"
                           id="name2" maxlength="30" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Отчество"/></td>
            <td><h:inputText value="#{bindBeanCrt.name2}"
                            id="name3" maxlength="45" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Телефон"/></td>
            <td><h:inputText value="#{bindBeanCrt.phone}"
                             id="tel" maxlength="50" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="E-mail"/></td>
            <td><h:inputText value="#{bindBeanCrt.email}"
                             id="email" maxlength="50" size="55"/></td>
            </tr>
              </table>
             </h:panelGroup> 
        
         </a4j:outputPanel>    
              </td>
              </tr>
              </table>
             <!--/rich:tab>
           
            </rich:tabPanel-->
            <table style="width:90%;">
            <!--tr>
            <td width="100px" height="20px">
            <h:outputText value="Организация"/></td>
            <td style="padding-top:5px;padding-bottom:5px;">
             <h:selectOneMenu style="width:300px;" 
                              value="#{bindBeanCrt.acOrganization}"
                              id="org">
             <f:selectItem itemLabel="+++" itemValue="-1"/>
	  	     <s:selectItems value="#{orgManager.listOrg}"
	  	               var="n"
	  	               label="#{n.fullName}"
                       itemValue="#{n.idOrg}"/>
             </h:selectOneMenu>
               </td>
            </tr-->
            
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Логин"/></td>
            <td><h:inputText value="#{bindBeanCrt.login}"
                             id="login" maxlength="50" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Пароль"/></td>
            <td><h:inputText value="#{bindBeanCrt.password}"
                        id="pass" maxlength="30" size="55"/></td>
            </tr>
             <tr>
            <td width="100px" height="20px">
            <h:outputText value="Номер сертификата"/></td>
            <td><h:inputText value="#{bindBeanCrt.certificate}"
                             id="cert" maxlength="50" size="55"/></td>
            </tr> 
            <tr>
             <td width="100px" height="25px">
               <h:outputText value="Дата начала"/></td>
             <td>
             <rich:calendar value="#{bindBeanCrt.start}"
				  locale="RU"
				  datePattern="dd.MM.yy"
				  todayControlMode="hidden"
				  id="sdate"/>
             </td>
            </tr>
            <tr>
             <td width="100px" height="25px">
               <h:outputText value="Дата окончания"/></td>
             <td>
             <rich:calendar value="#{bindBeanCrt.finish}"
				  locale="RU"
				  datePattern="dd.MM.yy"
				  todayControlMode="hidden"
				  id="fdate"/>
             </td>
            </tr>
          <tr>
            <td width="100px" height="20px">
            <h:outputText value="Статус"/></td>
            <td>
            <h:selectOneMenu value="#{bindBeanCrt.status}" 
                             style="width:100px;">
                   <!--f:selectItem itemLabel="Не активен" itemValue="0"/-->
                   <f:selectItem itemLabel="Активен" itemValue="1"/>
                   <f:selectItem itemLabel="Заблокирован" itemValue="2"/>
             </h:selectOneMenu> 
           </td>
          </tr> 
          <tr>
           <td colspan="2" align="center" height="35px">
              <a4j:commandButton value="Отмена"
                     onclick="#{rich:component('CBmpCrt')}.hide();return false;"
                     styleClass="but_class"/>
               <a4j:commandButton value="Сохранить"
                    action="#{bindManager.addBind}"
                    reRender="outCenterCenter, outCenterCenterFooter"
                    oncomplete="#{bindManager.addLoginExist ? 'alert(\'Такой логин уже существует!\')' : 'hideMPCrt();' }"
                    onclick="if(check_crt('CBformCrt')){return false;}"
                    styleClass="but_class">
                   <f:param name="onCreate" value="1"/> 
                   <f:param name="remoteAudit" value="CrtFact"/> 
                   <f:param name="#{param['sessionId']!=null ? 'sessionId' : 'xxx1'}" value="#{param['sessionId']}"/> 
              </a4j:commandButton>
            
              <!--a4j:commandButton value="Сохранить2"
                    action="#{bindManager.addBind}"
                    reRender="outCenterCenter,outAddMessage"
                    oncomplete="#{bindManager.addLoginExist ? 'alert(\'Такой логин уже существует!\')' : 'hideMPCrt();' }"
                    styleClass="but_class">
                   <f:param name="onCreate" value="1"/>  
              </a4j:commandButton-->
             </td>
            </tr>
            </table>
            
            </h:form>
        <!--/div-->
       </rich:modalPanel>
     </a4j:outputPanel>
     
     <a4j:outputPanel id="outCBmpUpd">  
      <rich:modalPanel id="CBmpUpd" rendered="#{param['onUpdate']!=null}"
        width="600" autosized="true" onbeforeshow="/*setHDiv('CBmpUpdHDiv');*/">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователь"></h:outputText>
             </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpUpd')}.hide();"
                value="/img/icons/close.gif"/>
              </h:panelGroup>
        </f:facet>
        <!--div id="CBmpUpdHDiv" style="width:100%;height:500px;overflow:auto;"-->
        <h:form id="CBformUpd">
        
        <!--h:inputHidden id ="uorgid" value="#{bindBean.acClOrganization}"/>
        <h:inputHidden id ="ucluid" value="#{bindBean.acClUser}"/-->
          
         <table style="width:90%;">
          <tr>
            <td width="100px" height="20px">
            <h:outputText value="Организация"/></td>
            <td><h:inputText value="#{bindBean.orgName}"
                 id="org" maxlength="30" size="55" disabled="true"/></td>
            </tr>
         <tr>
            <td colspan="2">
          <c:if test="#{param['onUpdate']!=null and bindBean.upSignUser==null}">
           <table style="width:99%;">
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Подразделение"/></td>
            <td><h:inputText value="#{bindBean.department}"
                 id="depart" maxlength="255" size="55"
                  disabled="true"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Должность"/></td>
            <td><h:inputText value="#{bindBean.position}"
                 id="doljn" maxlength="255" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Фамилия"/></td>
            <td><h:inputText value="#{bindBean.surname}"
                 id="name1" maxlength="45" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Имя"/></td>
            <td><h:inputText value="#{bindBean.name1}"
                  id="name2" maxlength="30" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Отчество"/></td>
            <td><h:inputText value="#{bindBean.name2}"
                 id="name3" maxlength="45" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Телефон"/></td>
            <td><h:inputText value="#{bindBean.phone}"
                 id="tel" maxlength="50" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="E-mail"/></td>
            <td><h:inputText value="#{bindBean.email}"
                id="email" maxlength="50" size="55"/></td>
            </tr>
             </table>
          </c:if>
          <c:if test="#{param['onUpdate']!=null and bindBean.upSignUser!=null}">
            <table style="width:99%;">
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="ФИО"/></td>
            <td><h:inputText value="#{bindBean.fio}"
                 id="fio" maxlength="120" size="55" disabled="true"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Должность"/></td>
            <td><h:inputText value="#{bindBean.position}"
                  id="dolj" maxlength="255" size="55" disabled="true"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Телефон"/></td>
            <td><h:inputText value="#{bindBean.phone}"
                 id="tel" maxlength="50" size="55" disabled="true"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="E-mail"/></td>
            <td><h:inputText value="#{bindBean.email}"
                 id="email" maxlength="50" size="55" disabled="true"/></td>
            </tr>
            </table>
           </c:if>
          </td>
         </tr>
         
           <!--tr>
            <td width="100px" height="20px">
            <h:outputText value="Фамилия"/></td>
            <td><h:inputText value="#{bindBean.surname}"
                 id="name1" maxlength="30" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Имя"/></td>
            <td><h:inputText value="#{bindBean.name1}"
                  id="name2" maxlength="30" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Отчество"/></td>
            <td><h:inputText value="#{bindBean.name2}"
                 id="name3" maxlength="30" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Телефон"/></td>
            <td><h:inputText value="#{bindBean.phone}"
                 id="tel" maxlength="50" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="E-mail"/></td>
            <td><h:inputText value="#{bindBean.email}"
                id="email" maxlength="50" size="55"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Организация"/></td>
            <td style="padding-top:5px;padding-bottom:5px;">
            <h:selectOneMenu style="width:300px;" id="org"
                             value="#{bindBean.acOrganization}">
             <f:selectItem itemLabel="+++" itemValue="-1"/>                   
	  	     <s:selectItems value="#{orgManager.listOrg}"
	  	               var="n"
	  	               label="#{n.fullName}"
                       itemValue="#{n.idOrg}"/>
             </h:selectOneMenu>
             </td>
            </tr-->
            
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Логин"/></td>
            <td><h:inputText value="#{bindBean.login}"
                id="login" maxlength="50" size="55"
                disabled="true"/></td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Пароль"/></td>
            <td><h:inputText value="#{bindBean.password}"
              id="pass" maxlength="30" size="55"/></td>
            </tr>
             <tr>
            <td width="100px" height="20px">
            <h:outputText value="Номер сертификата"/></td>
            <td><h:inputText value="#{bindBean.certificate}"
                id="cert" maxlength="50" size="55"/></td>
            </tr>
            <c:if test="#{param['onUpdate']!=null and currentUser.idUser!=bindBean.idUser}"> 
            <!--условие ослабленное, так как добавляется условие видимости кнопки 'изменить'.
                изменить сам себя может только суперюзер-->
            
            <!--c:if test="#{currentUser.idUser!=linksMap.superUserCode or bindBean.idUser!=linksMap.superUserCode}"--> 
             
             <tr>
             <td width="100px" height="25px">
               <h:outputText value="Дата начала"/></td>
             <td>
             <rich:calendar value="#{bindBean.start}"
				  locale="RU"
				  datePattern="dd.MM.yy"
				  todayControlMode="hidden"
				  id="sdate"/>
             </td>
            </tr>
            <tr>
             <td width="100px" height="25px">
               <h:outputText value="Дата окончания"/></td>
             <td>
             <rich:calendar value="#{bindBean.finish}"
				  locale="RU"
				  datePattern="dd.MM.yy"
				  todayControlMode="hidden"
				  id="fdate"/>
             </td>
            </tr>
            <tr>
            <td width="100px" height="20px">
            <h:outputText value="Статус"/></td>
            <td>
            <h:selectOneMenu value="#{bindBean.status}" 
                              style="width:100px;">
                   <!--f:selectItem itemLabel="Не активен" itemValue="0"/-->
                   <f:selectItem itemLabel="Активен" itemValue="1"/>
                   <f:selectItem itemLabel="Заблокирован" itemValue="2"/>
             </h:selectOneMenu> 
          </td>
            </tr> 
            
            </c:if>
          
            
            <!--/c:if-->
            
            <tr>
            <td colspan="2" align="center" height="35px">
                 <a4j:commandButton value="Отмена"
                     onclick="#{rich:component('CBmpUpd')}.hide();return false;"
                     styleClass="but_class"/>
                 <a4j:commandButton value="Сохранить"
                    action="#{bindManager.updBind}"
                    reRender="outCenterCenter, outCenterBottom"
                    oncomplete="#{rich:component('CBmpUpd')}.hide();"
                    onclick="if(check_upd('CBformUpd')){return false;}else{enableCHBox('CBformUpd');}" 
                    styleClass="but_class">
                    <f:param name="onUpdate" value="1"/> 
                    <f:param name="remoteAudit" value="UpdFact"/> 
                    <f:param name="sessionId" value="#{param['sessionId']}"/>
                    <f:param name="saveEditFlag" value="1"/>
                    <!--f:param name="shortData" 
                    value="#{(currentUser.idUser!=linksMap.superUserCode or bindBean.idUser!=linksMap.superUserCode ? '1' : ())}"/-->
              </a4j:commandButton>
             </td>
            </tr>
           </table>
          </h:form>
         <!--/div-->
     </rich:modalPanel>
  </a4j:outputPanel>
  
  <a4j:outputPanel id="outCBmpUpdRole">  
      <rich:modalPanel id="CBmpUpdRole" rendered="#{param['onUpdateRole']!=null}"
        width="600" autosized="true" 
        onbeforeshow="document.getElementById('CBformUpdRole:appl').value='-1'">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователь"></h:outputText>
             </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpUpdRole')}.hide();"
                value="/img/icons/close.gif"/>
              </h:panelGroup>
        </f:facet>
        <div id="CBmpUpdRoleHDiv" style="width:100%;overflow:auto;">
        <h:form id="CBformUpdRole">
        
        <!--h:inputHidden id ="uorgid" value="#{bindBean.acClOrganization}"/>
        <h:inputHidden id ="ucluid" value="#{bindBean.acClUser}"/-->
          
         <table style="width:90%;">
     
           <tr>
             <td width="100px" valign="top" height="25px">
            <h:outputText value="ИС"/></td>
            <td style="padding-top:5px;padding-bottom:5px;">
             <h:selectOneMenu style="width:300px;" 
                              id="appl" 
                              value="-1" 
                              immediate="true" onchange="invokeArmSelect(this.value)">
                <f:selectItem itemLabel="-------" itemValue="-1"/>              
	  	        <s:selectItems value="#{rolManager.listArm}" 
	                      var="n" 
                          label="#{n.name}"
                          itemValue="#{n.idArm}"/>         
               </h:selectOneMenu>
             </td>
            </tr>
            <tr>
             <td width="100px" valign="top">
                <h:outputText value="Роли:"/>
            </td>
            <td>
              <a4j:outputPanel id="outCBmpUpdRoleList" layout="block">
              <rich:dataTable id="CBdtUpdArmRole" style="width:100%" 
                               rowKeyVar="rkv" var="it_rl"
                               value="#{bindManager.roleList}">
                      <f:facet name="header">
                        <rich:columnGroup>
                         <rich:column>
                              <h:outputText value=" " />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Название" />
                          </rich:column>
                           <rich:column>
                              <h:outputText value="Код" />
                          </rich:column>
                        </rich:columnGroup>
                     </f:facet>
 
                     <rich:column>
                       <h:selectBooleanCheckbox value="#{it_rl.usrChecked}" id="CBsdtchbUpd"
                           disabled="#{param['remoteAudit']!='UpdFact' and (!(currentUser.idUser!=linksMap.superUserCode or bindBean.idUser!=linksMap.superUserCode) 
                                      or !(param['idArm']!=linksMap.appCode or it_rl.sign!='role:urn:sys_admin_cud' or currentUser.idUser==linksMap.superUserCode)
                                      or (currentUser.isSysAdmin!=1 and param['idArm']==linksMap.appCode))}"/>
                    </rich:column>
                    <rich:column>
                          <h:outputText value=" #{it_rl.roleTitle}" />
                     </rich:column>
                    <rich:column>
                            <h:outputText value=" #{it_rl.sign}" />
                     </rich:column>
                </rich:dataTable>
                    
              </a4j:outputPanel>
             </td>
            </tr>
            
            <!--tr>
             <td width="100px" valign="top">
               <h:outputText value="Роли:"/>
             </td>
             <td style="padding-top:5px;">
               <rich:dataTable id="CBdtUpd" style="width:100%" 
                               rowKeyVar="rkv" var="record"
                               value="#{bindManager.listBindArmEdit}">
                      <f:facet name="header">
                        <rich:columnGroup>
                          <rich:column colspan="2">
                              <h:outputText value="Название" />
                          </rich:column>
                        </rich:columnGroup>
                     </f:facet>
 
                     <rich:column colspan="2" style="font-weight:bold;">
                       <h:outputText value=" #{record.name}:" />
                    </rich:column>
                    <rich:subTable rowKeyVar="rkvs" id="CBsdtUpd"
                                   var="it" value="#{record.acRoles}">
                                  
 	                    <rich:column style="padding-left:30px;">
                       <h:selectBooleanCheckbox value="#{it.usrChecked}" id="CBsdtchbUpd"
                          onchange=""
                          onclick="fooNameUpd(this,'CBformUpd:CBdtUpd:'+#{rkv}+':CBsdtUpd:'+#{rkvs});" 
                          disabled="#{param['remoteAudit']!='UpdFact' and (!(currentUser.idUser!=linksMap.superUserCode or bindBean.idUser!=linksMap.superUserCode) 
                                      or !(record.idArm!=linksMap.appCode or it.sign!='role:urn:sys_admin_cud' or currentUser.idUser==linksMap.superUserCode)
                                      or (currentUser.isSysAdmin!=1 and record.idArm==linksMap.appCode))}"/>    
             
                           <h:outputText value=" #{it.roleTitle}"/>
                       </rich:column>
                     
                   </rich:subTable>
                 </rich:dataTable>
               </td>
            </tr-->
            
            <!--/c:if-->
            
            <tr>
            <td colspan="2" align="center" height="35px">
          
                 <a4j:commandButton value="Закрыть"
                     onclick="#{rich:component('CBmpUpdRole')}.hide();return false;"
                     styleClass="but_class"/>
               <a4j:outputPanel id="outCBmpUpdRoleButton"> 
                   
                 <a4j:commandButton value="Сохранить"
                    action="#{bindManager.updBindRole}"
                    reRender="outCenterCenter, outCenterBottom"
                    oncomplete="/*#{rich:component('CBmpUpdRole')}.hide();*/"
                    onclick="/*enableCHBox('CBformUpdRole')*/" 
                    styleClass="but_class" rendered="#{param['idArm']!=null and param['idArm']!='-1'}">
                    <f:param name="idArm" value="#{param['idArm']}"/>
                    <f:param name="onUpdateRole" value="1"/> 
                    <f:param name="remoteAudit" value="UpdFact"/> 
                    <f:param name="sessionId" value="#{param['sessionId']}"/>
                    <f:param name="saveEditFlag" value="1"/>
                    <!--f:param name="shortData" 
                    value="#{(currentUser.idUser!=linksMap.superUserCode or bindBean.idUser!=linksMap.superUserCode ? '1' : ())}"/-->
                </a4j:commandButton>
              
              
              </a4j:outputPanel>
             </td>
            </tr>
           </table>
          </h:form>
         </div>
     </rich:modalPanel>
  </a4j:outputPanel>
  
 <a4j:outputPanel id="outCBmpSearchForm">
  <rich:modalPanel id="CBmpSearchForm" 
        width="400" autosized="true" rendered="#{param['sessionId']!=null}"
        onbeforeshow="prepareSearchView();">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Поиск"></h:outputText>
             </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpSearchForm')}.hide();"
                value="/img/icons/close.gif"/>
              </h:panelGroup>
        </f:facet>
        
        <h:form id="CBformSearchForm">
        
        <table style="width:99%;" border="0">
     
         <tr>
           <td width="60px">
             <h:outputText value="Фамилия"/>
           </td>
           <td>
            <h:inputText id="search_fam" value="#{bindManager.fioArray[0]}" size="40" />
             <s:link title="Очистить" onclick="document.getElementById('CBformSearchForm:search_fam').value='';return false;">
                   <h:graphicImage value="/img/icons/data_clear.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>
            <s:link title="Востановить" onclick="document.getElementById('CBformSearchForm:search_fam').value=search_fam;return false;">
                   <h:graphicImage value="/img/icons/data_recover.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>
		   </td>
         </tr>
         <tr>
           <td >
             <h:outputText value="Имя"/>
           </td>
           <td>
            <h:inputText id="search_name" value="#{bindManager.fioArray[1]}" size="40"/>
            <s:link title="Очистить" onclick="document.getElementById('CBformSearchForm:search_name').value='';return false;">
                   <h:graphicImage value="/img/icons/data_clear.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>         
            <s:link title="Востановить" onclick="document.getElementById('CBformSearchForm:search_name').value=search_name;return false;">
                   <h:graphicImage value="/img/icons/data_recover.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>
           </td>
         </tr>
         <tr>
           <td >
             <h:outputText value="Отчество"/>
           </td>
           <td>
            <h:inputText id="search_otch" value="#{bindManager.fioArray[2]}" size="40"/>
            <s:link title="Очистить" onclick="document.getElementById('CBformSearchForm:search_otch').value='';return false;">
                   <h:graphicImage value="/img/icons/data_clear.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>
            <s:link title="Востановить" onclick="document.getElementById('CBformSearchForm:search_otch').value=search_otch;return false;">
                   <h:graphicImage value="/img/icons/data_recover.gif" 
                     styleClass="pic_tbar" 
                     style="border:0;vertical-align:middle;"/>
            </s:link>
           </td>
         </tr>
         <tr height="20px" align="center">
           <td colspan="2" >
            <h:selectBooleanCheckbox value="#{bindManager.searchOrgExact}" 
                            style="vertical-align:middle;" disabled="true"/>
             <h:outputText value="Только организация пользователя"/>
             
           </td>
         </tr>
         <tr>
            <td colspan="2" align="center" height="35px">
                 <a4j:commandButton value="Закрыть"
                     onclick="#{rich:component('CBmpSearchForm')}.hide();return false;"
                     styleClass="but_class"/>
                  <a4j:commandButton style="width:50px;" 
                    value="Искать"
                    reRender="outCBmpUpdGroup" ajaxSingle="false"
                    action="#{bindManager.search}"
                    oncomplete="/*#{rich:component('CBmpSearchForm')}.hide();*/#{rich:component('CBmpUpdGroup')}.show();"
                    onclick="if(check_search('CBformSearchForm')){return false;}"
                    styleClass="but_class">
            <f:param name="onUpdateGroup" value="1"/>
            <f:param name="remoteAudit" value="OpenUpdFact"/>
            <f:param name="sessionId" value="#{param['sessionId']}"/>
          </a4j:commandButton>   
         
             </td>
            </tr>
           </table>
          </h:form>
     </rich:modalPanel>
  
  <script>
//<![CDATA[
 
 var search_init_flag=0;          

//]]>
</script>

 </a4j:outputPanel>
   
   <a4j:outputPanel id="outCBmpUpdGroup">  
      <rich:modalPanel id="CBmpUpdGroup" rendered="#{param['onUpdateGroup']!=null}"
        width="900" autosized="true" onbeforeshow="setHDiv('CBmpUpdGroupHDiv');">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователи ИОГВ"></h:outputText>
             </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpUpdGroup')}.hide();"
                value="/img/icons/close.gif"/>
              </h:panelGroup>
        </f:facet>
        
        
         <rich:dataTable style="width:99%; background-color:#fffacd;" 
                               var="it_uzp"
                               value="#{bindBeanViewList}" columnsWidth="190px, 190px, 190px, 190px, *">
                      <f:facet name="header">
                        <rich:columnGroup>
                          <rich:column>
                              <h:outputText value="ФИО" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Организация" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Подразделение" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Должность" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Действие" />
                          </rich:column>
                          </rich:columnGroup>
                     </f:facet>
                    <rich:column>
                          <h:outputText value=" #{it_uzp.fio}" />
                     </rich:column>
                     <rich:column>
                          <h:outputText value=" #{it_uzp.orgName}" />
                     </rich:column>
                      <rich:column>
                          <h:outputText value=" #{it_uzp.department}" />
                     </rich:column>
                      <rich:column>
                          <h:outputText value=" #{it_uzp.position}" />
                     </rich:column>
                     <rich:column>
                       <table width="99%" border="0">
                       <tr>
                        <td align="center">
                         <table border="0">
                          <tr>
                           <td width="20px;" align="center">
                            
                            <s:link id="add_info_uzp_link" title="Дополнительная информация" onclick="return false;">
                             <h:graphicImage value="/img/icons/info_icon.gif" 
                             styleClass="pic_tbar" 
                             style="border:0;vertical-align:middle;"/>
                            </s:link>
                              <rich:toolTip direction="top-right" mode="client" 
                                 showEvent="onclick" 
                                 style="background-color:white; padding:3; margin:0;"
                                 layout="block" for="add_info_uzp_link">
                               <table style="">
                                <tr >
                                 <td width="50px;" style="padding:3px;">
                                   <h:outputText value="Телефон" />
                                 </td>
                                  <td style="padding:3px;">
                                   <h:outputText value="#{it_uzp.phone}" />
                                 </td>
                                </tr>
                                <tr>
                                 <td width="50px;" style="padding:3px;">
                                   <h:outputText value="Email" />
                                 </td>
                                  <td style="padding:3px;">
                                   <h:outputText value="#{it_uzp.email}" />
                                 </td>
                                 </tr>
                                 </table>
                                 
                               </rich:toolTip>
                            
                           </td>
                           <!--td width="20px;" align="center">
                           </td-->
                          </tr>
                         </table>
                        </td>
                       </tr>
                      </table>
                      </rich:column>
            </rich:dataTable>
         
        <div style="margin:5px;">
           <h:outputText value="Найденные соответствия:" />
        </div> 
        <div id="CBmpUpdGroupHDiv" style="width:100%;overflow:auto;">
        
        <h:form id="CBformUpdGroup">
        
        <table style="width:99%;">
     
         <tr>
           <td>
              <rich:dataTable id="CBdtUpdArmGroup" style="width:100%" 
                              rowKeyVar="rkv" var="it_iogv"
                              value="#{bindManager.applicantList}"
                              columnsWidth="190px, 190px, 190px, 190px, *"
                              rendered="#{not empty bindManager.applicantList}">
                      <!--f:facet name="header">
                        <rich:columnGroup>
                          <rich:column>
                              <h:outputText value="ФИО" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Организация" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Подразделение" />
                          </rich:column>
                          <rich:column>
                              <h:outputText value="Должность" />
                          </rich:column>
                           <rich:column>
                              <h:outputText value="Действия" />
                          </rich:column>
                          </rich:columnGroup>
                     </f:facet-->
                    <rich:column>
                          <h:outputText value=" #{it_iogv.fio}" />
                     </rich:column>
                     <rich:column>
                          <h:outputText value=" #{it_iogv.orgName}" />
                     </rich:column>
                      <rich:column>
                          <h:outputText value=" #{it_iogv.department}" />
                     </rich:column>
                      <rich:column>
                          <h:outputText value=" #{it_iogv.position}" />
                     </rich:column>
                      <rich:column>
                      <table width="99%" border="0">
                       <tr>
                        <td align="center">
                         <table border="0">
                          <tr>
                           <td width="20px;" align="center">
                            
                            <s:link id="add_info_link" title="Дополнительная информация" onclick="return false;">
                             <h:graphicImage value="/img/icons/info_icon.gif" 
                             styleClass="pic_tbar" 
                             style="border:0;vertical-align:middle;"/>
                            </s:link>
                              <rich:toolTip direction="top-right" mode="client" 
                                 showEvent="onclick" 
                                 style="background-color:white; padding:3; margin:0;"
                                 layout="block" for="add_info_link">
                               <table style="">
                                <tr >
                                 <td width="50px;" style="padding:3px;">
                                   <h:outputText value="Телефон" />
                                 </td>
                                  <td style="padding:3px;">
                                   <h:outputText value="#{it_iogv.phone}" />
                                 </td>
                                </tr>
                                <tr>
                                 <td width="50px;" style="padding:3px;">
                                   <h:outputText value="Email" />
                                 </td>
                                  <td style="padding:3px;">
                                   <h:outputText value="#{it_iogv.email}" />
                                 </td>
                                 </tr>
                                 </table>
                                 
                               </rich:toolTip>
                            
                           </td>
                           <td width="20px;" align="center">
                           <s:link title="Связать" 
                              onclick="if (confirm('Cвязать записи:
                                          \\n#{bindBeanViewList.get(0).fio} 
                                          \\nи 
                                          \\n#{it_iogv.fio} ?')){invokeBindRecords('#{it_iogv.usrCode}', '#{param['sessionId']}');} return false;">
                             <h:graphicImage value="/img/icons/link5.bmp" 
                             styleClass="pic_tbar" 
                             style="border:0;vertical-align:middle;"/>
                            </s:link>
                            </td>
                          </tr>
                         </table>
                        </td>
                       </tr>
                      </table>
                     </rich:column>
                   </rich:dataTable>
                  
                   <h:outputText value="Соответствий не найдено" 
                   rendered="#{empty bindManager.applicantList}"
                   style="color:red;"/>  
             </td>
            </tr>

            
            <tr>
            <td  align="center" height="35px">
          
                 <a4j:commandButton value="Закрыть"
                     onclick="#{rich:component('CBmpUpdGroup')}.hide();return false;"
                     styleClass="but_class"/>
               </td>
            </tr>
           </table>
          </h:form>
         </div>
     </rich:modalPanel>
  </a4j:outputPanel>
  
  <a4j:outputPanel id="outCBmpDel">
   <rich:modalPanel id="CBmpDel" rendered="#{param['onDelete']!=null}"
                    width="300" autosized="true">
      <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Пользователь"/>
             </h:panelGroup>
      </f:facet>
       <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage onclick="#{rich:component('CBmpDel')}.hide();"
                value="/img/icons/close.gif" />
              </h:panelGroup>
        </f:facet>
        <h:form>
         <h:inputHidden value="#{bindBean.idUser}"/>
         
         <h:outputText style="color:red;display:block;margin-bottom:7px;"
          value="#{bindManager.dellMessage}"/>
          
        <c:if test="#{bindManager.dellMessage==null}"> 
         <h:outputText style="display:block;margin-bottom:7px;"
          value="Удалить #{bindBean.fio}?"/>
        </c:if>
         
         <div style="white-space: nowrap;text-align:center;">
             <a4j:commandButton value="Отмена" 
                onclick="#{rich:component('CBmpDel')}.hide();return false;"
                styleClass="but_class"/>
           <c:if test="#{bindManager.dellMessage==null}">     
            <a4j:commandButton value="Удалить"
                    action="#{bindManager.delBind}"
                    reRender="outCenterCenter, outCenterCenterFooter, outCenterBottom, outCenterCenterHeader"
                    oncomplete="#{rich:component('CBmpDel')}.hide();"
                    styleClass="but_class" >
                 <f:param name="onDelete" value="1"/>
                 <f:param name="remoteAudit" value="DelFact"/>
             </a4j:commandButton>
            </c:if> 
            </div>
           </h:form>
        </rich:modalPanel>
      </a4j:outputPanel>
      
      
      
      </div>
      
 <script>
//<![CDATA[
           
var search_fam=null;
var search_name=null;
var search_otch=null;

function prepareSearchView(){

	if(search_init_flag==0){
		search_fam=document.getElementById("CBformSearchForm:search_fam").value;
		search_name=document.getElementById("CBformSearchForm:search_name").value;
		search_otch=document.getElementById("CBformSearchForm:search_otch").value;

		search_init_flag=1;
		
	}else{
		document.getElementById("CBformSearchForm:search_fam").value=search_fam;
		document.getElementById("CBformSearchForm:search_name").value=search_name;
		document.getElementById("CBformSearchForm:search_otch").value=search_otch;
	}
	
}


function check_search(tform){
	var msg="";

	 if ((jQuery.trim(document.getElementById(tform+":search_fam").value)=="")&&
		 (jQuery.trim(document.getElementById(tform+":search_name").value)=="")&&
		 (jQuery.trim(document.getElementById(tform+":search_otch").value)=="")){
		  msg+="Должно быть заполнено хотя бы одно поле !\n";
	 }
	
	 if(msg!=""){
	  alert(msg);
	  return true;
	 }else{
	  return false;
	}
}

function fooName(t,st){
		   if(t.checked){
		        jQuery("a[name='"+st+":CBsdtcl1Crt']").css('display','block');
		        jQuery("a[name='"+st+":CBsdtcl2Crt']").css('display','none');
	       }else{
       	        jQuery("a[name='"+st+":CBsdtcl1Crt']").css('display','none');
       	        jQuery("a[name='"+st+":CBsdtcl2Crt']").css('display','block');
           }
};
function fooNameUpd(t,st){
	   if(t.checked){
	        jQuery("a[name='"+st+":CBsdtcl1Upd']").css('display','block');
	        jQuery("a[name='"+st+":CBsdtcl2Upd']").css('display','none');
    }else{
	        jQuery("a[name='"+st+":CBsdtcl1Upd']").css('display','none');
	        jQuery("a[name='"+st+":CBsdtcl2Upd']").css('display','block');
    }
};
/*
function check(tform){
 var msg="";
 if (document.getElementById(tform+":name1").value==""){
	  msg+="Нет Фамилии !\n";
  }
 if (document.getElementById(tform+":name2").value==""){
	  msg+="Нет Имени !\n";
 }
 if (document.getElementById(tform+":name3").value==""){
	  msg+="Нет Отчества !\n";
 }
 if (document.getElementById(tform+":email").value==""){
	  msg+="Нет E-mail !\n";
 }
 if (document.getElementById(tform+":tel").value==""){
	  msg+="Нет Телефона !\n";
  }
 if(tform=='CBformCrt') {
   if (document.getElementById(tform+":login").value==""){
	  msg+="Нет Логина !\n";
  }
 }
 if (document.getElementById(tform+":pass").value==""){
	  msg+="Нет Пароля !\n";
 }
 if (document.getElementById(tform+":org").value=="-1"){
     msg+="Не выбрана Организация!\n";
 }

 if(msg!=""){
  alert(msg);
  return true;
 }else{
  return false;
}
}*/

function check_crt(tform){
	 var msg="";
	 if (document.getElementById(tform+":clorgso").value==""){
		  msg+="Не выбрана Организация !\n";
	  }
	 if(document.getElementById(tform+":cluso")!=null){
	   if (document.getElementById(tform+":cluso").value==""){
		  msg+="Не выбран Пользователь !\n";
	   }
     }else{
    	 if (jQuery.trim(document.getElementById(tform+":name1").value)==""){
    		  msg+="Нет Фамилии !\n";
    	 }
    	 if (jQuery.trim(document.getElementById(tform+":name2").value)==""){
    		  msg+="Нет Имени !\n";
    	 }
    	 if (jQuery.trim(document.getElementById(tform+":name3").value)==""){
    		  msg+="Нет Отчества !\n";
    	 }
     }
	/* if (document.getElementById(tform+":cert").value==""){
		  msg+="Нет Номера сертификата !\n";
	 }*/  
	 
	 if (jQuery.trim(document.getElementById(tform+":login").value)==""){
		  msg+="Нет Логина !\n";
	 }else{
		 if( jQuery.trim(document.getElementById(tform+":login").value).search(new RegExp(/[А-яёЁ]/g)) !=-1){
			 msg+="В Логине недопустима кириллица !\n";
	     }
	 }
	 if (jQuery.trim(document.getElementById(tform+":pass").value)==""){
		  msg+="Нет Пароля !\n";
	 }else{
		 if(jQuery.trim(document.getElementById(tform+":pass").value).search(new RegExp(/[А-яёЁ]/g)) !=-1){
			 msg+="В Пароле недопустима кириллица !\n";
	     }
	 }
	
	 if(msg!=""){
	  alert(msg);
	  return true;
	 }else{
	  return false;
	}
}

function check_upd(tform){
	var msg="";
	if(document.getElementById(tform+":fio")==null){
	 if ( jQuery.trim(document.getElementById(tform+":name1").value)==""){
   		  msg+="Нет Фамилии !\n";
   	 }
   	 if ( jQuery.trim(document.getElementById(tform+":name2").value)==""){
   		  msg+="Нет Имени !\n";
   	 }
   	 if ( jQuery.trim(document.getElementById(tform+":name3").value)==""){
   		  msg+="Нет Отчества !\n";
   	 }
    }  
	 if ( jQuery.trim(document.getElementById(tform+":pass").value)==""){
		  msg+="Нет Пароля !\n";
	 }else{
		 if(  jQuery.trim(document.getElementById(tform+":pass").value).search(new RegExp(/[А-яёЁ]/g)) !=-1){
			 msg+="В Пароле недопустима кириллица !\n";
	     }
	 }
	
	 if(msg!=""){
	  alert(msg);
	  return true;
	 }else{
	  return false;
	}
}

function setHDiv(hdiv){
	jQuery('#'+hdiv).height(Math.floor(jQuery(window).height()*(2/3)));
}
function setMPTop(){
	jQuery('#CBmpUpdRoleCDiv').css('top',Math.floor(jQuery(window).height()*(1/6)))
}

function hideMPCrt(){
	#{rich:component('CBmpCrt')}.hide();
}

function enableCHBox(tform){

	jQuery("input[name^='"+tform+":CBdtUpd'][type=checkbox]:disabled").removeAttr('disabled');
	
	/*var n= jQuery("input[name^='"+tform+":CBdtUpd'][type=checkbox]:disabled").length;

	alert(n);
	jQuery("input[name^='"+tform+":CBdtUpd'][type=checkbox]:disabled").removeAttr('disabled');

	n= jQuery("input[name^='"+tform+":CBdtUpd'][type=checkbox]:disabled").length;

	alert(n);*/
}

function reset_radio_stiu(tform){
	 jQuery("input[id='"+tform+":stiu:0'][type=radio]").attr('checked', true);
}

//CBformUpd:CBdtUpd:0:CBsdtUpd:0:CBsdtchbUpd
/*
if(document.getElementById(tform+":name1").value.length>45){
    msg+="Превышена длина поля Фамилия!\n";
}

jQuery("#myform input[type='radio']:checked").val();
jQuery('input:radio[name="gender"]').filter('[value="Male"]').attr('checked', true);
jQuery('input:radio[name="gender"][value="Male"]').prop('checked', true);*/
//]]>
</script>
</ui:composition>